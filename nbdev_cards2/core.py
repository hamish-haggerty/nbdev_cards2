# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/00_core.ipynb.

# %% auto 0
__all__ = ['foo', 'bar', 'C_z1z2']

# %% ../nbs/00_core.ipynb 4
import torch
if torch.cuda.is_available():device='cuda'
else:device='cpu'
import random
import os
import numpy as np
import math

# %% ../nbs/00_core.ipynb 5
def foo(): pass

# %% ../nbs/00_core.ipynb 6
def bar():
    
    return 'hi'

# %% ../nbs/00_core.ipynb 7
def C_z1z2(z1norm,z1norm_2,z2norm,z2norm_2,bs):
    """Input: bs*d shaped inputs z, which are bs-samples from d-dim random variables.
       Return: 0.5*corr(z1norm,z1norm_2) + 0.5*corr(z2norm,z2norm_2)
       which will be d*d dimensional, as sum of cross correlation matrices.
    """
    
    C1 =  (z1norm.T @ z2norm_2) / bs
    C2 = (z1norm_2.T @ z2norm) / bs
    return C1.pow(2) + 0.5*C2.pow(2)

